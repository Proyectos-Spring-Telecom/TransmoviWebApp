<div class="neo-wrap">
  <header class="neo-header">
    <div class="neo-avatar">
      <img [src]="resolvedAvatar" (error)="onAvatarError($event)" alt="avatar" />
    </div>

    <div class="neo-identity">
      <h1 class="neo-name">
        <span *ngIf="showNombre">{{ showNombre }}</span>
        <span *ngIf="showApellidoPaterno"> {{ showApellidoPaterno }}</span>
        <span *ngIf="showApellidoMaterno"> {{ showApellidoMaterno }}</span>
      </h1>
      <div class="neo-sub">
        <span *ngIf="user.usuario">{{ showRol }}</span>
        <span *ngIf="user.usuario"> · </span>
        <span class="neo-role">{{ showRolDescripcion }}</span>
      </div>
      <p class="neo-bio" *ngIf="user.bio">{{ showRolExtraDescripcion }}</p>

      <div class="neo-tags" *ngIf="user.tags?.length">
        Estatus:
        <span class="neo-tag" *ngFor="let t of user.tags; trackBy: trackByIndex">{{ t }}</span>
      </div>
    </div>
  </header>
  <section class="neo-columns">
    <article class="neo-panel info">
      <h2><i class="fa fa-id-badge"></i> Información</h2>

      <dl class="neo-dl">
        <div class="neo-item">
          <dt><i class="fa fa-envelope"></i> Correo</dt>
          <dd><a [href]="'mailto:' + user.email">{{ showCorreo }}</a></dd>
        </div>

        <div class="neo-item" *ngIf="user.telefono">
          <dt><i class="fa fa-phone"></i> Teléfono</dt>
          <dd><a [href]="'tel:' + user.telefono">{{ showTelefono }}</a></dd>
        </div>

        <div class="neo-item" *ngIf="user.ubicacion">
          <dt><i class="fa fa-map-marker"></i> Rol</dt>
          <dd>{{ showRol }}</dd>
        </div>

        <div class="neo-item" *ngIf="user.joinedAt">
          <dt><i class="fa fa-calendar"></i> Miembro desde</dt>
          <dd>{{ showCreacion }}</dd>
        </div>

        <div class="neo-item" *ngIf="user.joinedAt">
          <dt><i class="fa fa-calendar"></i> Último login</dt>
          <dd>{{ ultimoLogin || 'Sin registro' }}</dd>
        </div>
      </dl>
    </article>

    <article class="neo-panel security">
      <h2><i class="fa fa-key"></i> Cambiar contraseña</h2>

      <form class="neo-form" [formGroup]="passwordForm" (ngSubmit)="actualizarContrasena()" novalidate>
        <div class="fg">
          <div class="step">1</div>
          <label for="cp">Contraseña actual</label>
          <div class="control">
            <input id="cp" [type]="show.curr ? 'text' : 'password'" formControlName="passwordActual"
              placeholder="••••••••" autocomplete="current-password" />
            <button type="button" class="peek" (click)="show.curr = !show.curr" aria-label="Mostrar/ocultar">
              <i class="fa" [class.fa-eye]="!show.curr" [class.fa-eye-slash]="show.curr"></i>
            </button>
          </div>
          <div class="err" *ngIf="t('passwordActual').touched && t('passwordActual').hasError('required')">
            Requerida.
          </div>
        </div>

        <div class="fg">
          <div class="step">2</div>
          <label for="np">Nueva contraseña</label>
          <div class="control">
            <input id="np" [type]="show.neu ? 'text' : 'password'" formControlName="passwordNueva"
              (input)="onPasswordInput()" placeholder="Mínimo 8 caracteres" autocomplete="new-password" />
            <button type="button" class="peek" (click)="show.neu = !show.neu" aria-label="Mostrar/ocultar">
              <i class="fa" [class.fa-eye]="!show.neu" [class.fa-eye-slash]="show.neu"></i>
            </button>
          </div>
          <small class="hint" [@hintSwap]="hintVersion" [ngClass]="passwordStrengthColor" aria-live="polite"
            role="status">
            {{ passwordStrengthMsg }}
          </small>
          <div class="err" *ngIf="t('passwordNueva').touched && t('passwordNueva').hasError('required')">
            Requerida.
          </div>
        </div>

        <div class="fg">
          <div class="step">3</div>
          <label for="cf">Confirmar nueva contraseña</label>
          <div class="control">
            <input id="cf" [type]="show.conf ? 'text' : 'password'" formControlName="passwordNuevaConfirmacion"
              (input)="updateConfirmState()" placeholder="Repite la contraseña" autocomplete="new-password" />

            <button type="button" class="peek" (click)="show.conf = !show.conf" aria-label="Mostrar/ocultar">
              <i class="fa" [class.fa-eye]="!show.conf" [class.fa-eye-slash]="show.conf"></i>
            </button>
          </div>
          <small class="hint" [ngClass]="confirmState" *ngIf="confirmMsg">{{ confirmMsg }}</small>
          <div class="err"
            *ngIf="t('passwordNuevaConfirmacion').touched && t('passwordNuevaConfirmacion').hasError('required')">
            Requerida.
          </div>
        </div>

        <div class="actions mt-4">
          <button type="submit" class="btn GuardarForm" [disabled]="!canSave">Guardar</button>
          <button type="button" class="btn CancelarForm" (click)="onResetPassword()"
            [disabled]="loading">Cancelar</button>
        </div>
      </form>
    </article>
  </section>
</div>