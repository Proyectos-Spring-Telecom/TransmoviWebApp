<div class="neo-wrap">
  <!-- HEADER COMPACTO (sin banner) -->
  <header class="neo-header">
    <div class="neo-avatar">
      <img [src]="user.avatarUrl || 'assets/images/user_default.png'" alt="avatar" />
    </div>

    <div class="neo-identity">
      <h1 class="neo-name">{{ user.nombre }}</h1>
      <div class="neo-sub">
        <span *ngIf="user.usuario">{{ user.usuario }}</span>
        <span *ngIf="user.usuario"> · </span>
        <span class="neo-role">{{ user.rol }}</span>
      </div>
      <p class="neo-bio" *ngIf="user.bio">{{ user.bio }}</p>

      <div class="neo-tags" *ngIf="user.tags?.length">
        <span class="neo-tag" *ngFor="let t of user.tags; trackBy: trackByIndex">{{ t }}</span>
      </div>
    </div>
  </header>

  <!-- CONTENIDO: DOS PANELES -->
  <section class="neo-columns">
    <!-- Panel Información -->
    <article class="neo-panel info">
      <h2><i class="fa fa-id-badge"></i> Información</h2>

      <dl class="neo-dl">
        <div class="neo-item">
          <dt><i class="fa fa-envelope"></i> Correo</dt>
          <dd><a [href]="'mailto:' + user.email">{{ user.email }}</a></dd>
        </div>

        <div class="neo-item" *ngIf="user.telefono">
          <dt><i class="fa fa-phone"></i> Teléfono</dt>
          <dd><a [href]="'tel:' + user.telefono">{{ user.telefono }}</a></dd>
        </div>

        <div class="neo-item" *ngIf="user.ubicacion">
          <dt><i class="fa fa-map-marker"></i> Ubicación</dt>
          <dd>{{ user.ubicacion }}</dd>
        </div>

        <div class="neo-item" *ngIf="user.joinedAt">
          <dt><i class="fa fa-calendar"></i> Miembro desde</dt>
          <dd>{{ user.joinedAt | date:'dd/MM/yyyy' }}</dd>
        </div>

        <div class="neo-item" *ngIf="user.skills?.length">
          <dt><i class="fa fa-star"></i> Habilidades</dt>
          <dd class="neo-chips">
            <span class="chip" *ngFor="let s of user.skills; trackBy: trackByIndex">{{ s }}</span>
          </dd>
        </div>
      </dl>
    </article>

    <!-- Panel Cambiar contraseña (stepper) -->
    <article class="neo-panel security">
      <h2><i class="fa fa-lock"></i> Cambiar contraseña</h2>

      <form class="neo-form" [formGroup]="passwordForm" (ngSubmit)="onSubmitPassword()" novalidate>
        <!-- Paso 1 -->
        <div class="fg">
          <div class="step">1</div>
          <label for="cp">Contraseña actual</label>
          <div class="control">
            <input id="cp" [type]="show.curr ? 'text' : 'password'"
                   formControlName="currentPassword" placeholder="••••••••" autocomplete="current-password" />
            <button type="button" class="peek" (click)="show.curr = !show.curr" aria-label="Mostrar/ocultar">
              <i class="fa" [class.fa-eye]="!show.curr" [class.fa-eye-slash]="show.curr"></i>
            </button>
          </div>
          <div class="err" *ngIf="t('currentPassword').touched && t('currentPassword').hasError('required')">Requerida.</div>
        </div>

        <!-- Paso 2 -->
        <div class="fg">
          <div class="step">2</div>
          <label for="np">Nueva contraseña</label>
          <div class="control">
            <input id="np" [type]="show.neu ? 'text' : 'password'"
                   formControlName="newPassword" placeholder="Mínimo 8 caracteres" autocomplete="new-password" />
            <button type="button" class="peek" (click)="show.neu = !show.neu" aria-label="Mostrar/ocultar">
              <i class="fa" [class.fa-eye]="!show.neu" [class.fa-eye-slash]="show.neu"></i>
            </button>
          </div>
          <small class="hint">Usa mayúsculas, minúsculas y números.</small>
          <div class="err" *ngIf="t('newPassword').touched && t('newPassword').hasError('minlength')">Mínimo 8 caracteres.</div>
          <div class="err" *ngIf="t('newPassword').touched && t('newPassword').hasError('required')">Requerida.</div>
        </div>

        <!-- Paso 3 -->
        <div class="fg">
          <div class="step">3</div>
          <label for="cf">Confirmar nueva contraseña</label>
          <div class="control">
            <input id="cf" [type]="show.conf ? 'text' : 'password'"
                   formControlName="confirmPassword" placeholder="Repite la contraseña" autocomplete="new-password" />
            <button type="button" class="peek" (click)="show.conf = !show.conf" aria-label="Mostrar/ocultar">
              <i class="fa" [class.fa-eye]="!show.conf" [class.fa-eye-slash]="show.conf"></i>
            </button>
          </div>
          <div class="err" *ngIf="passwordForm.touched && passwordForm.hasError('passwordMismatch')">Las contraseñas no coinciden.</div>
          <div class="err" *ngIf="t('confirmPassword').touched && t('confirmPassword').hasError('required')">Requerida.</div>
        </div>

        <div class="actions">
          <button class="btn ghost" type="button" (click)="onResetPassword()" [disabled]="loading">
            <i class="fa fa-undo"></i> Limpiar
          </button>
          <button class="btn primary" type="submit" [disabled]="passwordForm.invalid || loading">
            <i class="fa fa-save"></i> Guardar cambios
          </button>
        </div>
      </form>
    </article>
  </section>
</div>
