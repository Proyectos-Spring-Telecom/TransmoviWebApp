<div class="container-fluid px-3 px-md-4 py-3 dashboard-wrap">
<!-- dashboard.component.html -->
<div class="dashboard container-fluid px-3 py-3">
  <div class="row g-3">
    <div class="col-12 col-md-6 col-lg-3" *ngFor="let k of kpis">
      <div class="card kpi">
        <div class="kpi-title">{{ renombrar(k.t) }}</div>
        <div class="kpi-value">{{ k.v }}</div>
        <div class="kpi-sub">{{ renombrar(k.s) }}</div>
      </div>
    </div>
  </div>

  <div class="row g-2 mt-2" *ngIf="etiquetasOriginales?.length">
    <div class="col-auto" *ngFor="let e of etiquetasOriginales">
      <span class="badge bg-secondary">{{ renombrar(e) }}</span>
    </div>
  </div>

  <div class="row g-3 mt-1">
    <div class="col-12 col-lg-6">
      <div class="card chart-card">
        <div class="card-title">{{ renombrar('Ingresos por hora (hoy)') }}</div>
        <dx-chart [dataSource]="dsIngresosHora" [palette]="palette" [size]="{ height: 320 }">
          <dxo-legend position="bottom"></dxo-legend>
          <dxo-argument-axis argumentType="string"></dxo-argument-axis>
          <dxo-tooltip [enabled]="true" [customizeTooltip]="customizeIngresosTooltip"></dxo-tooltip>
          <dxi-value-axis name="money">
            <dxo-label [format]="{ type: 'currency', precision: 2 }"></dxo-label>
          </dxi-value-axis>
          <dxi-value-axis name="ticket"></dxi-value-axis>
          <dxi-series type="bar" name="Ingresos" argumentField="hora" valueField="ingreso" axis="money"></dxi-series>
          <dxi-series type="line" name="Ticket promedio" argumentField="hora" valueField="ticket" axis="ticket"></dxi-series>
        </dx-chart>
      </div>
    </div>

    <div class="col-12 col-lg-6">
      <div class="card chart-card">
        <div class="card-title">{{ renombrar('Pasajeros por ruta') }}</div>
        <dx-chart
  [dataSource]="dsPasajerosPorHora"
  [series]="seriesPasajeros"
  [palette]="palette"
  [size]="{ height: 320 }">
  <dxo-common-series-settings type="stackedBar" argumentField="hora"></dxo-common-series-settings>
  <dxo-legend position="bottom"></dxo-legend>
  <dxo-argument-axis argumentType="string"></dxo-argument-axis>
</dx-chart>

      </div>
    </div>

    <div class="col-12 col-lg-6">
      <div class="card chart-card">
        <div class="card-title">{{ renombrar('Ascensos vs. boletos') }}</div>
        <dx-chart [dataSource]="dsBrecha" [palette]="palette" [size]="{ height: 320 }">
          <dxo-legend position="bottom"></dxo-legend>
          <dxo-argument-axis argumentType="string"></dxo-argument-axis>
          <dxi-series type="line" name="Ascensos" argumentField="hora" valueField="ascensos"></dxi-series>
          <dxi-series type="line" name="Boletos" argumentField="hora" valueField="boletos"></dxi-series>
        </dx-chart>
      </div>
    </div>

    <div class="col-12 col-lg-3">
      <div class="card chart-card">
        <div class="card-title">{{ renombrar('Medios de pago') }}</div>
        <dx-pie-chart [dataSource]="dsMediosPago" [palette]="palette" [size]="{ height: 320 }">
          <dxi-series type="doughnut" argumentField="medio" valueField="valor"></dxi-series>
          <dxo-legend position="bottom"></dxo-legend>
        </dx-pie-chart>
      </div>
    </div>

    <div class="col-12 col-lg-3">
      <div class="card chart-card">
        <div class="card-title">{{ renombrar('Puntualidad inicio de viaje') }}</div>
        <dx-chart [dataSource]="dsPuntualidad" [palette]="palette" [size]="{ height: 320 }">
          <dxo-legend [visible]="false"></dxo-legend>
          <dxo-argument-axis argumentType="string"></dxo-argument-axis>
          <dxi-series type="bar" argumentField="bin" valueField="viajes" name="Viajes"></dxi-series>
        </dx-chart>
      </div>
    </div>
  </div>

  <div class="row g-3 mt-1">
    <div class="col-12 col-xl-6">
      <div class="card list-card">
        <div class="card-title">{{ renombrar('Top 5 rutas por ingreso') }}</div>
        <dx-data-grid class="dx-grid-dark" [dataSource]="topRutas" [columnAutoWidth]="true" [rowAlternationEnabled]="true" [showBorders]="false">
          <dxi-column dataField="nombre" [caption]="renombrar('Ruta')"></dxi-column>
          <dxi-column dataField="ingresos" [caption]="renombrar('Ingresos')" dataType="number" format="currency" alignment="right"></dxi-column>
          <dxi-column dataField="viajes" [caption]="renombrar('Viajes')" dataType="number" alignment="center"></dxi-column>
        </dx-data-grid>
      </div>
    </div>

    <div class="col-12 col-xl-6">
      <div class="card list-card">
        <div class="card-title">{{ renombrar('Dispositivos con alertas') }}</div>
        <dx-data-grid class="dx-grid-dark" [dataSource]="dispositivosConAlertas" [rowAlternationEnabled]="true" [showBorders]="false">
          <dxi-column dataField="nombre" [caption]="renombrar('Equipo')"></dxi-column>
          <dxi-column dataField="motivo" [caption]="renombrar('Motivo')"></dxi-column>
          <dxi-column dataField="minSinPos" [caption]="renombrar('Min sin posiciÃ³n')" dataType="number" alignment="center"></dxi-column>
          <dxi-column dataField="estatus" [caption]="renombrar('Estatus')" alignment="center"></dxi-column>
          <dxi-column [caption]="renombrar('Tipo')" cellTemplate="tipoTpl"></dxi-column>
          <ng-template dxTemplate="tipoTpl" let-data>
            <span class="chip" [ngClass]="data.data.tipo">{{ renombrar(data.data.tipo) }}</span>
          </ng-template>
        </dx-data-grid>
      </div>
    </div>
  </div>
</div>

</div>